<!DOCTYPE HTML>
<html>

<head>
    <link rel="stylesheet" href="http://cdn.webix.com/edge/webix.css" type="text/css">
    <script src="http://cdn.webix.com/edge/webix.js" type="text/javascript"></script>
    <link rel="stlyesheet" href="css/facetCSS.css" type="text/css">
    <script src="config.js" type="text/javascript"></script>
    <script src="girderHelpers.js" type="text/javascript"></script>
    <style>
    /* Key parameter for setting up my template!! New CSS Trick below */

    .template-image {
        width: 100%;
        height: inherit;
    }
    </style>
</head>

<body>
    <script type="text/javascript" charset="utf-8">
    /* place for UI configuration */

    var header = {
        view: "template",
        type: "header",
        template: "Keras Simpsons Model Viewer, by Raj"
    }

  // <input type="button" name="" value="Template A" onclick="$$('movie').define('type','typeA');$$('movie').render();">
	 //    <input type="button" name="" value="Template B" onclick="$$('movie').define('type','typeB');$$('movie').render();">



    // drag: true,
    //             type: {
    //                 height: 180
    //             },
    //             template: "#name# <br> <img src='" +config.BASE_URL + "/item/#_id#/tiles/thumbnail?height=60'>  #meta.characterClass# #meta.imgSourceId#" ,
    //             on:

	 webix.type(webix.ui.dataview,{
			name:"smallThumb",
			template: "<img src='" +config.BASE_URL + "/item/#_id#/tiles/thumbnail?height=60'>",
			width: 65,
            height: 65
		});

		webix.type(webix.ui.dataview,{
			name:"mediumThumb",
			template: "<img src='" +config.BASE_URL + "/item/#_id#/tiles/thumbnail?height=128'>",
			width: 130,
            height: 130
		});


	 webix.type(webix.ui.dataview,{
			name:"namedThumb",
			template: "<div class='overall'><div class='rank'>#rank#.</div><div class='title'>#title#</div><div class='year'>#year# year</div> </div>",
			width: 260,
            height: 90
		});




    var LeftPanel = {
        id: "leftPanel",
        view: "dataview",
        select: true,
        gravity: 0.2,
        type: {
            template: "<b>#name#</b> ",
            height: 100
        },
        on: {
            "onAfterRender": webix.once(function(id) {
                girderHelpers('listFoldersinFolder', config.CBIR_FolderRootID).then(function(folderList) {
                    var folderListData = JSON.parse(folderList);
                    $$("leftPanel").parse(folderListData);
                    $$("leftPanel").refresh();

                })
            }),
            // onAfterLoad: function() {
            //     firstId = $$("leftPanel").getFirstId()
            //     $$("leftPanel").select(firstId);
            // },
            "onAfterSelect": function(id) {

                var folder = this.getItem(id);
                girderHelpers('listItemsInFolder', folder._id).then(function(itemList) {
                    $$("mainThumbGallery").clearAll();
                    $$("mainThumbGallery").parse(JSON.parse(itemList));
                    $$("mainThumbGallery").refresh();
                })

                // $$("imgClasses").setHTML($$("mainImgTable").count());
                // selectedDataSet = $$("mainImgTable").getItem(id);
                // // console.log(selectedDataSet);
                // $$("mainThumbGallery").clearAll();
                // $$("mainThumbGallery").parse(selectedDataSet.imgSet);

                // // ]},m.setHTML("HII"
                // $$("imgCount").setHTML($$("mainThumbGallery").count());
            }

        }
    }


// $$("mainThumbGallery").define('type','namedThumb');  $$("mainThumbGallery").refresh()
//http://adrc.digitalslidearchive.emory.edu:8080/api/v1/item/596e3c5d92ca9a000b2af7f7/tiles/thumbnail
    var mainThumbGallery = {
        rows: [{
                gravity: 0.1,
                cols: [
                    { id: "imgCount", view: "template", template: "imgCount" },
                    { id: "imgClasses", view: "template", template: "imgClasses" },
                    { id: "thumbTemplate", view: "template", template: "ChangeThumbTemplate" }

                ]
            },
            {
                view: "dataview",
                id: "mainThumbGallery",
                select: true,
                multiselect: true,
                drag: true,
                type: {
                    height: 180
                },
                template: "#name# <br> <img src='" +config.BASE_URL + "/item/#_id#/tiles/thumbnail?height=60'>  #meta.characterClass# #meta.imgSourceId#" ,
                on:

                    {
                        "onAfterSelect": function(id)
                                {
                                    webix.message("clickity clickity")
                                    webix.message(id);
                                    itemInfo = this.getItem(id);
                                    console.log(itemInfo);
                                }
                    }
            }
        ]
    }

    dragAndDropTarget = {
        gravity: 0.2,
        rows: [

            { view: "template", template: "Drag And Drop Target", gravity: 0.2 },
            {

                view: "dataview",
                id: "dragTarget",
                autoconfig: true,
                select: true,
                multiselect: true,
                drag: true,

                type: {
                    height: 80
                },
                template: "#name# <img src='#ComingSoon#' class='template-image' >"
            }
        ]
    }


    webix.ui({
        rows: [header,
            {
                cols: [
                    LeftPanel,
                    mainThumbGallery,
                    dragAndDropTarget
                ]
            }
        ]
    })
    </script>
</body>

</html>